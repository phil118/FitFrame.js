!function(t,i,e,s){function a(i,e,s){this.element=t(i),this.options=t.extend({},s,e),this._defaults=s,this._init()}a.prototype={update:function(){"resize"===this.options.mode?this._resizeNew():(this._calcWrapped(),this._wrapNew())},wrap:function(i){var e=t(i).data("width")||t(i).attr("width")||t(i).width(),s=t(i).data("height")||t(i).attr("height")||t(i).height();"100%"===e&&(e=t(i).width());var a=100*this._calculateRatio(e,s)+"%";if(this.options.limitToNativeWidth){var n=t('<div class="fitframe-limit" style="max-width: '+e+'px"><div class="'+this.options.wrapperCssClass+'" style="padding-bottom: '+a+'"></div></div>');return i.wrap(n).parent(".fitframe-limit")}var r=t("<div/>").addClass(this.options.wrapperCssClass).css("padding-bottom",a);return i.wrap(r).parent()},resize:function(t){return this._setupIframe(t),this._resizeIframe(t,this.element.width(),this.element.height(),this.options.fitHeight),t},destroy:function(){var i=this;"resize"===i.options.mode?(this.element.find("iframe."+this.options.iframeCssClass).each(function(){var e=t(this).data("fitFrame");t(this).removeClass(i.options.iframeCssClass).width(e.width).height(e.height).data("fitFrame",null)}),this._unbind()):this.element.find("."+this.options.wrapperCssClass).children().unwrap(),this.element.data("plugin_fitFrame",null)},_init:function(){this.options.fitHeight&&(this.options.mode="resize"),"resize"===this.options.mode&&this._bind(),this.update()},_calcWrapped:function(){var i=this;i.element.find("iframe").filter(function(){return t(this).closest("."+i.options.wrapperCssClass).length}).each(function(){var e=t(this).data("width")||t(this).attr("width")||t(this).width(),s=t(this).data("height")||t(this).attr("height")||t(this).height(),a=100*i._calculateRatio(e,s)+"%";t(this).parent("."+i.options.wrapperCssClass).css("padding-bottom",a)})},_wrapNew:function(){var i=this;this.element.find("iframe").filter(function(){return!t(this).closest("."+i.options.wrapperCssClass).length}).each(function(){i.wrap(t(this))})},_resizeNew:function(){var i=this;t("iframe").not(this.options.iframeCssClass).each(function(){i._setupIframe(t(this))}),this._resizeAll()},_setupIframe:function(i){var e=t(i).data("width")||t(i).attr("width")||t(i).width(),s=t(i).data("height")||t(i).attr("height")||t(i).height();i.data("fitFrame",{ratio:this._calculateRatio(e,s),width:e,height:s}).addClass(this.options.iframeCssClass)},_resizeAll:function(){var i=this,e=this.options.containerWidth.call(this),s=this.options.containerHeight.call(this),a=this.options.fitHeight;this.element.find("iframe."+this.options.iframeCssClass).each(function(){i._resizeIframe(t(this),e,s,a)})},_resizeIframe:function(t,i,e,s){var a=t.data("fitFrame").ratio;s&&i*a>e?t.height(e).width(e/a):t.height(i*a).width("100%")},_calculateRatio:function(t,i){return(i/t).toPrecision(4)},_bind:function(){var e,s=this;t(i).on("resize.fitFrame",function(){clearTimeout(e),e=setTimeout(function(){s._resizeAll()},100)})},_unbind:function(){t(i).off(".fitFrame")}},t.fn.fitFrame=function(i){var e,s=arguments;return this.each(function(){var n=t.data(this,"plugin_fitFrame");if(n){if("string"==typeof i&&"_"!==i[0]){var r=n[i];"function"==typeof r?e=r.apply(n,Array.prototype.slice.call(s,1)):t.error("Public method '"+i+"' does not exist on jQuery.fitFrame")}}else t.data(this,"plugin_fitFrame",new a(this,i,t.fn.fitFrame.defaults))}),void 0!==e?e:this},t.fn.fitFrame.defaults={wrapperCssClass:"fitframe-wrap",iframeCssClass:"fitframe",mode:"wrap",fitHeight:!1,containerHeight:function(){return this.element.height()},containerWidth:function(){return this.element.width()},limitToNativeWidth:!1}}(jQuery,window,document);